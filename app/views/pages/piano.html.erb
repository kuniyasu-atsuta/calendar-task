<% provide(:title, "piano") %>
<% provide(:css, (stylesheet_link_tag 'bootstrap.min',
                                      'piano',
                                      'keys',
                                      'icons',
                                      'style')) %>
<% provide(:js1, (javascript_include_tag 'vend/jquery-1.7.2.min',
                                         'vend/jquery-ui-1.8.20.custom.min',
                                         'modernizr.min')) %>

<% keys = ['C3', 'Db3', 'D3', 'Eb3', 'E3', 'F3', 'Gb3', 'G3', 'Ab3', 'A3',
         'Bb3', 'B3', 'C4', 'Db4', 'D4', 'Eb4', 'E4', 'F4', 'Gb4', 'G4',
         'Ab4', 'A4', 'Bb4', 'B4', 'C5', 'Db5', 'D5', 'Eb5', 'E5', 'F5',
         'Gb5', 'G5', 'Ab5', 'A5', 'Bb5', 'B5', 'C6'] %>

   <% for i in keys do %>
     <%= audio_tag("samples/#{i}.mp3", id: "sound-#{i}", preload: "auto") %>
   <% end %>

   <div id="wrapper">

     <%= render 'layouts/top_bar', locals: {title: "piano"} %>
     <%= render 'layouts/left_sidebar' %>
       <div class="content-page bg-light">
           <!-- Start content -->
         <div class="content">
           <div class="row mx-2 mt-4">
           <div class="container-fluid col-sm-4 col-md-4 col-xl-3 mt-5 shadow px-0 h-50 pb-0">
             <div class="bg-custom pl-0">
                <div class="ml-3 h-100">
                  <p class="">説明</p>
                </div>
             </div>
             <div class="ml-2 example">

               <p class="ml-2 mr-2 mt-4" style="line-height: 30px;">まず考えられるのが当たり前ですが、楽器ですよね。<br>作曲に最も適した楽器はピアノだと言われています。<br>それは両手を使って和音とメロディーを同時に弾けるからです。 <br>  ギターでも、もちろん作曲をされているプロは多いです。<br><br>ただギターの方が和音とメロディーを自由自在に鳴らせるようになるのに時間が掛かると思います。<br>音階の並び方がピアノほどストレートではないからです。<br> まだ何も楽器は弾けないという方はピアノやキーボード、シンセなど鍵盤楽器の方をお奨めします。ひとまず音は鳴ってくれますしね。<br><br>  キーボードとシンセサイザーは割と混同されることが多いですが、厳密には違います。キーボードは電子ピアノに代表されるようにピアノ音色を主体として、エレクトリック・ピアノ、ストリングス、ハープシコードなどスタンダードな音を得意としています。オルガンもキーボードの仲間ですね。   一方、シンセサイザーは電子音を作ることを主眼に置いているので、本格的なシンセほどピアノなどのスタンダードな音はほとんど鳴らせません。なぜキーボードと混同されるようになったのかというと、90年代くらいからPCMシンセと言って生音をサンプリングした音色が搭載されることが多くなったため、ピアノの音も電子音もどんな音も鳴らせるようになったことが影響しています。  初めて鍵盤楽器を買う時は、ピアノの音が鳴らせるものを選んだ方が良いです。作曲する時はやっぱりピアノの音が一番メロディー作りに向いているからです。 あとは自分の今後のビジョンによって選ぶ鍵盤楽器が変わってきます。    作曲のみに興味がある人の場合。 「作曲だけできればOK」「僕は歌うことがすべてです」という人はピアノだけが鳴るものを選ぶと良いと思います。ピアノ音色だけに特化されている分、音の質感のグレードが高いので長く使えると思います。一生使っても良いと思います。   作曲だけじゃなくて編曲やミックスにも興味がある人の場合。 「サウンドも作りたい」「ボカロに歌わせてリリースしたい」という人は先述のPCMシンセやソフト音源を選択されることをお奨めします。ピアノだけでは様々なサウンドを形にしていくことは出来ませんし、いろいろな音色に慣れていくのも大切だからです。音色からメロディーがインスパイアされることも多いので、あらゆる音に親しんでいくことで曲作りの奥深さを知ることが出来ると思います。 バンドメンバーとのやり取りや、編曲家とのやり取りなど、歌メロをアカペラ音源としてやり取りする場面は必ず出てきます。その時に活躍してくれるのが様々な録音アプリです。 </p>
             </div>
           </div>
           <div class="container-fluid col-sm-8 col-md-8 col-xl-9 mt-5">
             <div class="mt-2 mb-5">

               <p>まず考えられるのが当たり前ですが、 バンドメンバーとのやり取りや、編曲家とのやり取りなど、歌メロをアカペラ音源としてやり取りする場面は必ず出てきます。その時に活躍してくれるのが様々な録音アプリです。 </p>
             </div>
             <div class="piano">
               <noscript class="piano-javascript">This program requires Javascript and HTML5 Audio support.</noscript>
               <div class="piano-container">
                 <div class="piano-keys">
                   <div class="piano-white piano-C4"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Db4"></div></div>
                   <div class="piano-white piano-D4">D4</div>
                   <div class="piano-black"><div class="piano-black-raised piano-Eb4"></div></div>
                   <div class="piano-white piano-E4"></div>
                   <div class="piano-white piano-F4"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Gb4"></div></div>
                   <div class="piano-white piano-G4"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Ab4"></div></div>
                   <div class="piano-white piano-A4"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Bb4"></div></div>
                   <div class="piano-white piano-B4"></div>
                   <div class="piano-white piano-C5"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Db5"></div></div>
                   <div class="piano-white piano-D5"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Eb5"></div></div>
                   <div class="piano-white piano-E5"></div>
                   <div class="piano-white piano-F5"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Gb5"></div></div>
                   <div class="piano-white piano-G5"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Ab5"></div></div>
                   <div class="piano-white piano-A5"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Bb5"></div></div>
                   <div class="piano-white piano-B5"></div>
                   <div class="piano-white piano-C6"></div>
                 </div>
                 <div class="piano-keys">
                   <div class="piano-white piano-C3"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Db3"></div></div>
                   <div class="piano-white piano-D3"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Eb3"></div></div>
                   <div class="piano-white piano-E3"></div>
                   <div class="piano-white piano-F3"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Gb3"></div></div>
                   <div class="piano-white piano-G3"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Ab3"></div></div>
                   <div class="piano-white piano-A3"></div>
                   <div class="piano-black"><div class="piano-black-raised piano-Bb3"></div></div>
                   <div class="piano-white piano-B3"></div>
                   <div class="piano-white piano-C4"></div>
                 </div>
                 <div class="piano-pedal">Just listen to that sustain!</div>
               </div>
             </div>


          <style>
            body {
              color: #666;
              font-family: Helvetica Neue,Helvetica,Arial,sans-serif;
            }
            h2 {
              font-weight: normal;
              font-size: 18px;
            }
            .section > div {
              display: inline-block;
              margin: 2px;
            }
          </style>
        <div class="container">
        <div class="piano-container">
          <div class="section">
            <div>
              <icon class="keyboard-key `"></icon>
            </div>
            <div>
              <icon class="keyboard-key one"></icon>
            </div>
            <div>
              <icon class="keyboard-key two"></icon>
            </div>
            <div>
              <icon class="keyboard-key three"></icon>
            </div>
            <div>
              <icon class="keyboard-key four"></icon>
            </div>
            <div>
              <icon class="keyboard-key five"></icon>
            </div>
            <div>
              <icon class="keyboard-key six"></icon>
            </div>
            <div>
              <icon class="keyboard-key seven"></icon>
            </div>
            <div>
              <icon class="keyboard-key eight"></icon>
            </div>
            <div>
              <icon class="keyboard-key nine"></icon>
            </div>
            <div>
              <icon class="keyboard-key zero"></icon>
            </div>
            <div>
              <icon class="keyboard-key zero"></icon>
            </div>
            <div>
              <icon class="keyboard-key zero"></icon>
            </div>
            <div>
              <icon class="keyboard-key delete"></icon>
            </div>
          </div>
          <div class="section">
            <div>
              <icon class="keyboard-key tab"></icon>
            </div>
            <div>
              <icon class="keyboard-key q"></icon>
            </div>
            <div>
              <icon class="keyboard-key w"></icon>
            </div>
            <div>
              <icon class="keyboard-key e"></icon>
            </div>
            <div>
              <icon class="keyboard-key r"></icon>
            </div>
            <div>
              <icon class="keyboard-key t"></icon>
            </div>
            <div>
              <icon class="keyboard-key y"></icon>
            </div>
            <div>
              <icon class="keyboard-key u"></icon>
            </div>
            <div>
              <icon class="keyboard-key i"></icon>
            </div>
            <div>
              <icon class="keyboard-key o"></icon>
            </div>
            <div>
              <icon class="keyboard-key p"></icon>
            </div>
            <div>
              <icon class="keyboard-key af"></icon>
            </div>
            <div>
              <icon class="keyboard-key ag"></icon>
            </div>
            <div>
              <icon class="keyboard-key ah"></icon>
            </div>
          </div>
          <div class="section">
            <div>
              <icon class="keyboard-key caps"></icon>
            </div>
            <div>
              <icon class="keyboard-key a"></icon>
            </div>
            <div>
              <icon class="keyboard-key s"></icon>
            </div>
            <div>
              <icon class="keyboard-key d"></icon>
            </div>
            <div>
              <icon class="keyboard-key f"></icon>
            </div>
            <div>
              <icon class="keyboard-key g"></icon>
            </div>
            <div>
              <icon class="keyboard-key h"></icon>
            </div>
            <div>
              <icon class="keyboard-key j"></icon>
            </div>
            <div>
              <icon class="keyboard-key k"></icon>
            </div>
            <div>
              <icon class="keyboard-key l"></icon>
            </div>
            <div>
              <icon class="keyboard-key as"></icon>
            </div>
            <div>
              <icon class="keyboard-key ad"></icon>
            </div>
            <div>
              <icon class="keyboard-key return"></icon>
            </div>
          </div>
          <div class="section">
            <div>
              <icon class="keyboard-key shift"></icon>
            </div>
            <div>
              <icon class="keyboard-key z"></icon>
            </div>
            <div>
              <icon class="keyboard-key x"></icon>
            </div>
            <div>
              <icon class="keyboard-key c"></icon>
            </div>
            <div>
              <icon class="keyboard-key v"></icon>
            </div>
            <div>
              <icon class="keyboard-key b"></icon>
            </div>
            <div>
              <icon class="keyboard-key n"></icon>
            </div>
            <div>
              <icon class="keyboard-key m"></icon>
            </div>
            <div>
              <icon class="keyboard-key ,"></icon>
            </div>
            <div>
              <icon class="keyboard-key ."></icon>
            </div>
            <div>
              <icon class="keyboard-key /"></icon>
            </div>
            <div>
              <icon class="keyboard-key shift"></icon>
            </div>
          </div>
          <div class="section">
            <div class="mx-auto">
              <icon class="keyboard-key space mx-auto"></icon>
            </div>
          </div>
          <div class="my-5">
            <%= link_to 'lesson2' do%>
            <button type="button" class="btn btn-primary btn-rounded w-md waves-effect waves-light m-b-5">確認して次へ</button>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>
  <%= render 'layouts/right_bar' %>
</div>
<script>
  var icons = document.querySelectorAll('icon')
  var button = document.querySelectorAll('button')[0]

  // button.addEventListener('click', switchTheme)

  function switchTheme() {
    var l = icons.length
    while (l--) icons[l].classList.toggle('dark')
  }

  window.addEventListener('keydown', classy('add', 'keyboard-keydown'))
  window.addEventListener('keyup', classy('remove', 'keyboard-keydown'))

  function classy (method, className) {
    return function (e) {
      var els = getKeyEl(e)
      while (els.length) els.pop().classList[method](className)
    }
  }

  var keyMap = {
    8: 'delete',
    9: 'tab',
    13: 'return',
    16: 'shift',
    17: 'ctrl',
    18: 'alt, .keyboard-key.option',
    27: 'esc',
    32: 'space',
    91: 'cmd',
    37: 'left',
    38: 'up',
    39: 'right',
    40: 'down'
  }

  function getKeyEl (e) {
    var char = String.fromCharCode(e.which)
    if (e.which >= 112 && e.which < 112 + 12) {
      char = 'f' + (e.which - 111)
    } else if (keyMap[e.which]) {
      char = keyMap[e.which]
    } else if (/\d/.test(char)) {
      char = ['zero','one','two','three','four', 'five','six','seven','eight','nine'][Number(char)]
    }
    if (char) {
      var charEl = document.querySelectorAll('.keyboard-key.' + char.toLowerCase())
      if (charEl.length) return [].slice.call(charEl)
    }
  }
</script>

<% provide(:js2, (javascript_include_tag 'detect',
                                         'fastclick',
                                         'jquery.blockUI',
                                         'waves',
                                         'jquery.core',
                                         'jquery.app',
                                         'piano.js')) %>
